<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบ 5 ภาษารัก</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #FFF0F5; /* Lavender Blush */
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .btn-option {
            transition: all 0.2s;
        }
        .btn-option:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-100 to-purple-100 min-h-screen flex items-center justify-center p-4">

    <div class="max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden relative fade-in" id="app-container">
        <!-- Progress Bar -->
        <div class="h-2 bg-gray-100 w-full" id="progress-container" style="display:none;">
            <div id="progress-bar" class="h-full bg-pink-500 transition-all duration-300" style="width: 0%"></div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="p-8 text-center">
            <div class="w-24 h-24 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-heart text-4xl text-pink-500"></i>
            </div>
            <h1 class="text-3xl font-bold text-gray-800 mb-2">ค้นหา "ภาษารัก" ในตัวคุณ</h1>
            <p class="text-gray-600 mb-8">ตอบคำถาม 10 ข้อ เพื่อค้นหารูปแบบความรักที่คุณต้องการมากที่สุด</p>
            <button onclick="startQuiz()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 rounded-xl shadow-lg transition-colors text-lg">
                เริ่มทำแบบทดสอบ
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="p-6 hidden">
            <div class="mb-6 flex justify-between items-center">
                <span class="text-sm font-semibold text-pink-500" id="question-number">ข้อที่ 1/10</span>
                <span class="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-full">เลือกข้อที่ใจฟูที่สุด</span>
            </div>
            
            <h2 id="question-text" class="text-xl font-semibold text-gray-800 mb-6 leading-relaxed">
                คำถามจะปรากฏที่นี่...
            </h2>

            <div id="options-container" class="space-y-3">
                <!-- Options generated by JS -->
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="p-8 hidden text-center">
            <div class="w-32 h-32 mx-auto mb-6 relative">
                <div class="absolute inset-0 bg-pink-200 rounded-full opacity-50 animate-pulse"></div>
                <div class="relative w-full h-full bg-white rounded-full flex items-center justify-center border-4 border-pink-500 shadow-inner">
                    <i id="result-icon" class="fas fa-gift text-5xl text-pink-500"></i>
                </div>
            </div>
            
            <p class="text-gray-500 mb-1">ภาษารักของคุณคือ</p>
            <h2 id="result-title" class="text-3xl font-bold text-gray-800 mb-4 text-pink-600">
                Words of Affirmation
            </h2>
            
            <div class="bg-pink-50 rounded-xl p-4 mb-6 text-left">
                <p id="result-desc" class="text-gray-700 text-sm leading-relaxed">
                    คำอธิบายผลลัพธ์...
                </p>
            </div>

            <!-- Ranking Section Added Here -->
            <div id="ranking-container" class="mb-8 text-left space-y-4">
                <!-- Scores will be injected here -->
            </div>

            <div class="space-y-3">
                <button onclick="shareResult()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-xl shadow transition-colors flex items-center justify-center gap-2">
                    <i class="fab fa-facebook"></i> แชร์ผลลัพธ์
                </button>
                <button onclick="restartQuiz()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 rounded-xl transition-colors">
                    ทำแบบทดสอบอีกครั้ง
                </button>
            </div>
        </div>
    </div>

    <!-- Hidden Input for Copying -->
    <textarea id="share-text" class="hidden"></textarea>

    <script>
        // Database of Questions
        // Mapping: Words (A), Acts (B), Gifts (C), Time (D), Touch (E) -> but adjusted per question logic
        const questions = [
            {
                q: "ในวันคล้ายวันเกิด สิ่งที่ทำให้คุณใจฟูที่สุดคือ?",
                options: [
                    { text: "การ์ดอวยพรซึ้งๆ หรือโพสต์ยาวๆ ถึงคุณ", type: "words" },
                    { text: "เขาจัดงานปาร์ตี้ให้ จัดการทุกอย่างให้เสร็จ", type: "acts" }, // or service
                    { text: "ของขวัญที่คุณเคยบ่นว่าอยากได้", type: "gifts" },
                    { text: "เขาเคลียร์คิวงานเพื่อมาอยู่กับคุณทั้งวัน", type: "time" },
                    { text: "กอดแน่นๆ จูบ และสัมผัสที่อบอุ่น", type: "touch" }
                ]
            },
            {
                q: "เวลาที่คุณเหนื่อยมากๆ จากงาน คุณอยากให้คนรักทำอะไร?",
                options: [
                    { text: "พูดให้กำลังใจ ชมว่าคุณเก่งมาก", type: "words" },
                    { text: "ช่วยนวดไหล่ นวดหลัง หรือกอด", type: "touch" },
                    { text: "ซื้อขนมเจ้าโปรดติดมือมาฝาก", type: "gifts" },
                    { text: "รีบทำงานบ้านให้ หรือเตรียมน้ำอุ่นไว้รอ", type: "acts" },
                    { text: "นั่งฟังคุณระบายเงียบๆ อยู่ข้างๆ", type: "time" }
                ]
            },
            {
                q: "การกระทำแบบไหนที่ทำให้คุณรู้สึก 'ไม่มั่นคง' ที่สุด?",
                options: [
                    { text: "เขาปฏิเสธที่จะสัมผัสตัว หรือเดินหนี", type: "touch" },
                    { text: "เขาไม่เคยซื้อของอะไรให้เลย แม้แต่วันสำคัญ", type: "gifts" },
                    { text: "เขาเอาแต่เล่นเกม/มือถือ เวลาอยู่ด้วยกัน", type: "time" },
                    { text: "เขาพูดจาห้วนๆ ประชด หรือวิจารณ์แรงๆ", type: "words" },
                    { text: "เขารับปากแล้วลืม หรือขี้เกียจทำสิ่งที่ขอ", type: "acts" }
                ]
            },
            {
                q: "ถ้าแฟนต้องไปต่างจังหวัด 3 วัน คุณคาดหวังอะไร?",
                options: [
                    { text: "วิดีโอคอลคุยกันทุกคืน เล่าเรื่องละเอียดๆ", type: "time" }, // Detailed talk = connection
                    { text: "ส่งข้อความหวานๆ บอกรักเช้า-เย็น", type: "words" },
                    { text: "ซื้อของฝากเล็กๆ น้อยๆ กลับมาให้", type: "gifts" },
                    { text: "ดูแลตัวเองดีๆ และจัดการธุระทางบ้านให้", type: "acts" },
                    { text: "รีบกลับมากอดให้หายคิดถึงทันทีที่ถึง", type: "touch" }
                ]
            },
            {
                q: "คุณรู้สึกประทับใจที่สุด เมื่อคนรักของคุณ...",
                options: [
                    { text: "สังเกตเห็นทรงผม/เสื้อใหม่ แล้วเอ่ยปากชม", type: "words" },
                    { text: "ซ่อมของเสีย เปลี่ยนหลอดไฟ ทำงานจุกจิกให้", type: "acts" },
                    { text: "จำวันครบรอบได้ แล้วเตรียมของขวัญมา", type: "gifts" },
                    { text: "วางแผนทริปเที่ยวโดยใส่ใจตารางเวลาคุณ", type: "time" },
                    { text: "เดินจับมือคุณตลอดเวลาที่ไปเดินห้าง", type: "touch" }
                ]
            },
            {
                q: "การทะเลาะกันแบบไหน ที่ทำให้คุณเจ็บปวดฝังใจที่สุด?",
                options: [
                    { text: "ทำลายข้าวของ หรือขว้างปาของขวัญที่ให้", type: "gifts" },
                    { text: "ด่าทอ ใช้คำหยาบคาย หรือพูดดูถูก", type: "words" },
                    { text: "เมินเฉย เย็นชา ไม่ยอมแตะเนื้อต้องตัว", type: "touch" },
                    { text: "ปล่อยให้คุณแบกภาระแก้ปัญหาคนเดียว", type: "acts" },
                    { text: "เดินหนีไปเลย ไม่ยอมอยู่ปรับความเข้าใจ", type: "time" } // Abandonment
                ]
            },
            {
                q: "กิจกรรมวันหยุดแบบไหนที่คุณ 'เลิฟ' ที่สุด?",
                options: [
                    { text: "นอนกอดกันดูหนัง หรือนอนเล่นบนเตียง", type: "touch" },
                    { text: "ไปเดินเลือกซื้อของด้วยกัน ผลัดกันซื้อให้", type: "gifts" },
                    { text: "ขับรถเที่ยวไกลๆ ได้คุยกันลึกซึ้งระหว่างทาง", type: "time" },
                    { text: "ช่วยกันทำความสะอาดบ้าน จัดห้องให้น่าอยู่", type: "acts" },
                    { text: "นั่งคุยแลกเปลี่ยนไอเดีย ผลัดกันชมอีกฝ่าย", type: "words" }
                ]
            },
            {
                q: "คุณจะรู้สึก 'แย่' มาก ถ้าคนรักของคุณ...",
                options: [
                    { text: "ลืมวันเกิดของคุณ หรือมามือเปล่า", type: "gifts" },
                    { text: "ไม่เคยเอ่ยปากชม หรือขอบคุณสิ่งที่คุณทำให้", type: "words" },
                    { text: "ไม่ช่วยงานบ้าน ปล่อยให้คุณทำจนหัวหมุน", type: "acts" },
                    { text: "เวลาคุยกัน เขาเอาแต่มองไปทางอื่น/ดูทีวี", type: "time" },
                    { text: "ปัดมือคุณออกเวลาคุณจะจับ", type: "touch" }
                ]
            },
            {
                q: "วิธีบอกรักแบบไหนที่ 'ได้ผล' กับคุณที่สุด?",
                options: [
                    { text: "'ผม/ฉัน รักคุณนะ' (พูดบ่อยๆ)", type: "words" },
                    { text: "การกระทำที่แสดงความห่วงใย (กางร่ม/ห่มผ้า)", type: "acts" },
                    { text: "การสัมผัส (ลูบหัว/จับมือ/หอมแก้ม)", type: "touch" },
                    { text: "การให้เวลา (หยุดงานมาอยู่กับคุณ)", type: "time" },
                    { text: "การให้สิ่งของ (ดอกไม้/ขนม/สิ่งแทนใจ)", type: "gifts" }
                ]
            },
            {
                q: "ถ้าเลือกได้เพียงอย่างเดียว คุณอยากได้อะไรตอนนี้?",
                options: [
                    { text: "ช่วยเคลียร์งาน/ธุระที่คั่งค้างให้จบๆ ไป", type: "acts" },
                    { text: "พาไปดินเนอร์ แล้วนั่งคุยกันแบบไม่มีมือถือ", type: "time" },
                    { text: "อยากได้ยินเขาบอกว่า 'ภูมิใจในตัวคุณนะ'", type: "words" },
                    { text: "ของขวัญชิ้นพิเศษที่เล็งไว้มานาน", type: "gifts" },
                    { text: "กอดแน่นๆ สัก 5 นาที", type: "touch" }
                ]
            }
        ];

        const results = {
            words: {
                title: "Words of Affirmation (คำพูดเติมเต็มใจ)",
                desc: "คุณต้องการได้ยินคำบอกรัก คำชมเชย หรือคำพูดให้กำลังใจ การพูดจาดีๆ คือกุญแจสำคัญที่ทำให้คุณรู้สึกมีค่า ในทางกลับกัน คำพูดรุนแรงจะทำร้ายจิตใจคุณมากที่สุด",
                icon: "fa-comments"
            },
            acts: {
                title: "Acts of Service (การดูแลเทคแคร์)",
                desc: "สำหรับคุณ 'การกระทำสำคัญกว่าคำพูด' คุณจะรู้สึกถูกรักเมื่อเห็นเขาลงมือช่วยแบ่งเบาภาระของคุณ ไม่ว่าจะเป็นงานบ้าน หรือเรื่องเล็กๆ น้อยๆ ที่แสดงถึงความใส่ใจ",
                icon: "fa-hands-helping"
            },
            gifts: {
                title: "Receiving Gifts (ของขวัญแทนใจ)",
                desc: "คุณให้ความสำคัญกับสิ่งของที่เป็นตัวแทนของความรู้สึก ไม่จำเป็นต้องราคาแพง แต่ต้องแสดงว่า 'เขาคิดถึงคุณ' การลืมวันสำคัญหรือให้ของแบบขอไปทีคือสิ่งต้องห้าม",
                icon: "fa-gift"
            },
            time: {
                title: "Quality Time (เวลาที่มีคุณภาพ)",
                desc: "สิ่งที่คุณต้องการที่สุดคือ 'ความสนใจทั้งหมด' (Undivided Attention) การได้ทำกิจกรรมร่วมกัน ได้คุยกันโดยไม่มีมือถือหรือสิ่งรบกวน คือช่วงเวลาทองของคุณ",
                icon: "fa-clock"
            },
            touch: {
                title: "Physical Touch (การสัมผัสทางกาย)",
                desc: "คุณรับรู้ความรักผ่านการสัมผัส การจับมือ กอด หรือนั่งใกล้ๆ ทำให้คุณรู้สึกอบอุ่นและปลอดภัย หากขาดการสัมผัส คุณจะรู้สึกเหมือนถูกทอดทิ้งทันที",
                icon: "fa-hand-holding-heart"
            }
        };

        let currentQuestion = 0;
        let scores = { words: 0, acts: 0, gifts: 0, time: 0, touch: 0 };

        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('progress-container').style.display = 'block';
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('question-number').innerText = `ข้อที่ ${currentQuestion + 1}/${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            
            // Update Progress Bar
            const progress = ((currentQuestion) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            // Shuffle options slightly to avoid pattern (optional, keeping fixed for consistency now)
            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "btn-option w-full text-left p-4 rounded-xl border-2 border-pink-100 hover:border-pink-400 hover:bg-pink-50 bg-white text-gray-700 font-medium text-sm md:text-base flex items-center gap-3 shadow-sm";
                btn.onclick = () => selectOption(opt.type);
                btn.innerHTML = `<div class="w-6 h-6 rounded-full border-2 border-pink-200 flex-shrink-0"></div><span>${opt.text}</span>`;
                optionsContainer.appendChild(btn);
            });
        }

        function selectOption(type) {
            scores[type]++;
            currentQuestion++;

            if (currentQuestion < questions.length) {
                // Add fade out effect
                const container = document.getElementById('quiz-screen');
                container.classList.add('opacity-50');
                setTimeout(() => {
                    renderQuestion();
                    container.classList.remove('opacity-50');
                }, 200);
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('progress-container').style.display = 'none';
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('result-screen').classList.add('fade-in');

            // 1. Convert scores object to array and sort descending
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            
            // 2. Get Winner Info
            const winnerKey = sortedScores[0][0];
            const winnerInfo = results[winnerKey];

            // 3. Update Main Display
            document.getElementById('result-title').innerText = winnerInfo.title;
            document.getElementById('result-desc').innerText = winnerInfo.desc;
            
            const iconEl = document.getElementById('result-icon');
            iconEl.className = `fas ${winnerInfo.icon} text-5xl text-pink-500`;

            // 4. Render Ranking List (New Feature)
            const rankingEl = document.getElementById('ranking-container');
            rankingEl.innerHTML = '<h3 class="text-gray-800 font-bold mb-3 border-b border-gray-200 pb-2">คะแนนรายด้านของคุณ</h3>';
            
            sortedScores.forEach(([key, score]) => {
                const info = results[key];
                const percent = (score / questions.length) * 100; // Based on total questions (10)
                
                const itemHtml = `
                    <div class="mb-2">
                        <div class="flex justify-between items-end mb-1">
                            <span class="text-sm font-medium text-gray-700">
                                <i class="fas ${info.icon} text-pink-400 w-5 text-center mr-1"></i>
                                ${info.title}
                            </span>
                            <span class="text-xs font-bold text-gray-500">${score} คะแนน</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-2.5 overflow-hidden">
                            <div class="bg-gradient-to-r from-pink-300 to-pink-500 h-full rounded-full transition-all duration-1000 ease-out" style="width: ${percent}%"></div>
                        </div>
                    </div>
                `;
                rankingEl.innerHTML += itemHtml;
            });
        }

        function restartQuiz() {
            currentQuestion = 0;
            scores = { words: 0, acts: 0, gifts: 0, time: 0, touch: 0 };
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
        }

        function shareResult() {
            const title = document.getElementById('result-title').innerText;
            const text = `ฉันเพิ่งทำแบบทดสอบภาษารัก ผลลัพธ์ของฉันคือ: "${title}"`;
            
            // Modern Share API
            if (navigator.share) {
                navigator.share({
                    title: 'ผลแบบทดสอบ 5 ภาษารัก',
                    text: text,
                    url: window.location.href,
                }).catch(console.error);
            } else {
                // Fallback for desktop
                navigator.clipboard.writeText(text).then(() => {
                    alert('คัดลอกผลลัพธ์แล้ว! นำไปโพสต์ได้เลยครับ');
                });
            }
        }
    </script>
</body>
</html>